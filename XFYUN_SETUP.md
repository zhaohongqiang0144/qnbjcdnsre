# 🎤 讯飞语音识别配置指南

## 📋 前提条件

- 已注册讯飞开放平台账号
- 已实名认证(部分服务需要)

## 🚀 快速配置步骤

### 1. 注册讯飞开放平台

访问 [讯飞开放平台控制台](https://console.xfyun.cn)

### 2. 创建应用

1. 登录后点击 **"控制台"**
2. 点击 **"创建新应用"**
3. 填写应用信息:
   - **应用名称**: map-navigator (或自定义)
   - **应用平台**: 选择 **"WebAPI"**
   - **应用简介**: AI地图导航助手
4. 点击 **"提交"** 创建应用

### 3. 开通语音听写服务

1. 在控制台找到刚创建的应用
2. 点击 **"添加服务"**
3. 搜索 **"语音听写(流式版)"**
4. 点击 **"开通"** (免费版每日500次调用)
5. 确认开通协议

### 4. 获取API凭证

在应用详情页面,你会看到:

```
APPID: xxxxxxxx
APIKey: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
APISecret: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

### 5. 配置 .env 文件

将获取的凭证填入项目根目录的 `.env` 文件:

```bash
# 讯飞语音识别 - 在 https://console.xfyun.cn 申请
XFYUN_APPID=你的APPID
XFYUN_API_KEY=你的APIKey
XFYUN_API_SECRET=你的APISecret
```

## ✅ 验证配置

### 1. 重启服务器

```bash
npm start
```

### 2. 测试语音功能

1. 打开浏览器访问 `http://localhost:3000`
2. 点击麦克风按钮 🎤
3. 授权浏览器使用麦克风
4. 说出导航指令,例如: **"去故宫"**
5. 等待5秒或再次点击按钮停止录音
6. 查看识别结果

## 🆓 免费额度说明

讯飞语音听写(流式版)免费版:
- **每日调用量**: 500次
- **音频时长**: 每次最长60秒
- **并发数**: 2个

> 💡 **提示**: 对于个人开发和测试,免费额度完全足够使用!

## 🔧 常见问题

### Q1: 提示"连接语音服务失败"

**可能原因:**
- API凭证配置错误
- 未开通"语音听写(流式版)"服务
- 网络连接问题

**解决方法:**
1. 检查 `.env` 文件中的凭证是否正确
2. 确认已在控制台开通服务
3. 重启服务器

### Q2: 识别结果不准确

**解决方法:**
1. 尽量在安静环境下说话
2. 对准麦克风清晰发音
3. 避免方言,使用普通话
4. 说完后等待2-3秒再停止录音

### Q3: 超出免费额度怎么办?

**选项:**
1. 升级到付费版本(按量计费)
2. 使用其他账号创建新应用
3. 等待第二天额度重置

## 📊 监控使用情况

在讯飞控制台可以查看:
- 今日调用次数
- 历史调用统计
- 错误率分析
- 响应时间

## 🔐 安全建议

1. ✅ **不要**将 `.env` 文件提交到Git仓库
2. ✅ 定期更换API凭证
3. ✅ 监控异常调用
4. ✅ 设置调用频率限制

## 📚 相关文档

- [讯飞语音听写API文档](https://www.xfyun.cn/doc/asr/voicedictation/API.html)
- [错误码说明](https://www.xfyun.cn/document/error-code)
- [SDK下载](https://www.xfyun.cn/sdk)

---

**配置完成后,你的语音识别功能就可以在国内稳定使用了!** 🎉
